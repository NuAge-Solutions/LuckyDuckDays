OJ.importJs("oj.components.Spinner");OJ.importJs("oj.events.Event");OJ.importCss("oj.media.Media");"use strict";OJ.extendClass(OjComponent,"OjMedia",{_props_:{resizeBy:"width",source:null,showSpinner:false,spinnerTint:"#333"},_loaded:false,_original_w:null,_original_h:null,_source_is_css:false,_constructor:function(){this._super("OjMedia","_constructor",[]);this.setVertAlign(OjStyleElement.MIDDLE);if((this.media=this._makeMedia())&&isObjective(this.media)){this.media.addClasses("media");this.addChild(this.media)}if(arguments.length){this.setSource(arguments[0])}},_destructor:function(){this._unset("media");this._unset("loading");return this._super("OjMedia","_destructor",arguments)},_makeMedia:function(){},_resize:function(){if(this._source_is_css){this.media.setWidth(OjStyleElement.AUTO);this.media.setHeight(OjStyleElement.AUTO);return}var b=this._getStyleBackup("width"),c=this._getStyleBackup("height");if(!isEmpty(b)){this.media.setWidth("100","%");if(c){this.media.setHeight("100","%")}else{this.media.setHeight(OjStyleElement.AUTO)}}else{if(!isEmpty(c)){this.media.setHeight("100","%");this.media.setWidth(OjStyleElement.AUTO)}else{if(this._resizeBy==this._static.WIDTH){this.media.setWidth("100","%");this.media.setHeight(OjStyleElement.AUTO)}else{this.media.setHeight("100","%");this.media.setWidth(OjStyleElement.AUTO);var a=this.getWidth();if(b>a){this.media.setMarginLeft((a-b)/2)}}}}},_setSource:function(a){this._source_is_css=(this._source=a).charAt(0)=="@";this.media.setWidth(OjStyleElement.AUTO);this.media.setHeight(OjStyleElement.AUTO);this.media.setMaxWidth(OjStyleElement.AUTO);this.media.setMaxHeight(OjStyleElement.AUTO)},_onMediaLoad:function(a){this._unset("loading");this._loaded=true;if(this._source_is_css){this._original_w=this.media.getWidth();this._original_h=this.media.getHeight()}else{this._original_w=this.media.dom().width;this._original_h=this.media.dom().height}if(this._original_w){this.media.setMaxWidth(this._original_w)}if(this._original_h){this.media.setMaxHeight(this._original_h)}this._resize();this.dispatchEvent(new OjEvent(OjEvent.LOAD))},isLoaded:function(){return this._loaded},setHeight:function(a){this._super("OjMedia","setHeight",arguments);if(a==OjStyleElement.AUTO||arguments.length>1){this._resize()}},setInnerHeight:function(a){this._super("OjMedia","setInnerHeight",arguments);this._resize()},setInnerWidth:function(a){this._super("OjMedia","setInnerWidth",arguments);this._resize()},getOriginalHeight:function(){return this._original_h},getOriginalWidth:function(){return this._original_w},setSource:function(a){if(Array.isArray(a)){a=a.join(", ")}else{if(a){a=a.toString()}}if(this._source==a){return}if(!this.loading&&this._showSpinner){this.addChild(this.loading=new OjSpinner(this._spinnerTint))}this._setSource(a)},setResizeBy:function(a){if(this._resizeBy==a){return}this._resizeBy=a;this._resize()},setWidth:function(a){this._super("OjMedia","setWidth",arguments);if(a==OjStyleElement.AUTO||arguments.length>1){this._resize()}}},{HEIGHT:"height",WIDTH:"width"});